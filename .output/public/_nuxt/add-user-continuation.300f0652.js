import{_ as g}from"./nuxt-link.bdbb5b1b.js";import{a as c,b as a,e as s,w as f,f as d,v as h,F as m,r as p,h as v,t as u,i as b,j as C,k as y,o as i,l as w,p as S,m as x}from"./entry.452b7f3a.js";import{u as D}from"./index.ac9df0f7.js";import"./sweetalert2.all.fce410fa.js";import{_ as k}from"./_plugin-vue_export-helper.c27b6911.js";import"./swiper-vue.05a5116d.js";const P={data(){return{data:null,countriesData:[],selectedCountry:null,provincesData:[],selectedProvince:null,citiesData:[],selectedCity:null,address:"",error:"",userData:D()}},created(){},mounted(){localStorage.getItem("CupidConnectToken")&&this.$router.push("/home"),localStorage.getItem("CupidConnectFirstRegisterData")&&(this.data=JSON.parse(localStorage.getItem("CupidConnectFirstRegisterData"))),this.fetchCountries()},methods:{async submitForm(){if(this.verify()){const r={_email:this.data._email,_username:this.data._username,_fname:this.data._fname,_lname:this.data._lname,_password:this.data._password,country:this.selectedCountry,province:this.selectedProvince,city:this.selectedCity,_address:this.address,_dob:this.data._dob},e=await c.post("https://espacionebula.com:8000/create-user",r,{headers:{"Access-Control-Allow-Origin":"*"},mode:"cors"});if(e.data.success){debugger;localStorage.setItem("CupidConnectToken",e.data.token),localStorage.setItem("CupidConnectEmail",e.data.user._email),localStorage.setItem("CupidConnectuser",e.data.user._username),localStorage.setItem("CupidConnectType",e.data.user._type),localStorage.setItem("CupidConnectId",e.data.user._id),this.userData.setEmail(localStorage.getItem("CupidConnectEmail")),this.userData.setuser(localStorage.getItem("CupidConnectuser")),localStorage.removeItem("CupidConnectFirstRegisterData"),this.$router.push("/profile/validation-1")}else this.error="There was an error creating user : "+e.data.error,console.log("There was an error creating user : "+e.data.error),this.clearErrorMessageAfterDelay()}},async fetchCountries(){try{const r=await c.get("https://espacionebula.com:8000/get-countries",{headers:{"Access-Control-Allow-Origin":"*","Content-Type":"multipart/form-data"},mode:"cors"});this.countriesData=r.data.countries,this.countriesData.length>0&&(this.selectedCountry="",this.selectedProvince="",this.selectedCity="")}catch(r){console.error("Error in fetchCountries:",r)}},verify(){return this.selectedCountry?this.selectedProvince?this.selectedCity?this.address?this.address.length<8?(this.error="Your address must have at least 8 characters",console.log("Your address must have at least 8 characters"),!1):!0:(this.error="Please write your address",console.log("Please write your address"),!1):(this.error="Please select a city",console.log("Please select a city"),!1):(this.error="Please select a province",console.log("Please select a province"),!1):(this.error="Please select a country",console.log("Please select a country"),!1)},clearErrorMessageAfterDelay(){setTimeout(()=>{this.error=""},5e3)},async handleSelectChange(){if(this.provincesData=[],this.selectedCountry!=="")try{const r={country_id:this.selectedCountry},e=await c.post("https://espacionebula.com:8000/get-province-by-country",r,{headers:{"Access-Control-Allow-Origin":"*"},mode:"cors"});this.provincesData=e.data.provinces,e.data.success&&this.provincesData.length>0&&(this.selectedProvince="",this.selectedCity="")}catch(r){console.error("Error in handleSelectChange:",r)}},async handleSelectProvinceChange(){if(this.citiesData=[],this.selectedProvince!=="")try{const r={province_id:this.selectedProvince},e=await c.post("https://espacionebula.com:8000/get-cities-by-province",r,{headers:{"Access-Control-Allow-Origin":"*"},mode:"cors"});this.citiesData=e.data.cities,e.data.success&&this.citiesData.length>0&&(this.selectedCity="")}catch(r){console.error("Error in handleSelectProvinceChange:",r)}}}},l=r=>(S("data-v-d04a281d"),r=r(),x(),r),I={class:"container mx-auto mt-4"},A={class:"grid grid-cols-12 gap-5"},F=l(()=>s("div",{id:"Logo",class:"col-span-12 md:col-span-7 bg-black-200 p-4 flex justify-center"},[s("h2",{class:"text-xl font-semibold"})],-1)),E={id:"content",class:"col-span-12 bg-black p-4 lg:border-l white h-full md:col-span-5 md:border-l"},T=l(()=>s("h2",{id:"Register",class:"text-xl font-semibold text-white flex flex-col justify-center items-center"},"Register",-1)),U={class:"mb-8 grid grid-cols-12 items-center relative"},V=l(()=>s("option",{value:"",disabled:"",selected:""},"Select a country",-1)),L=["value"],M={class:"mb-8 grid grid-cols-12 items-center relative"},N=l(()=>s("option",{value:"",disabled:"",selected:""},"Select a province",-1)),O=["value"],R={class:"mb-8 grid grid-cols-12 items-center relative"},j=l(()=>s("option",{value:"",disabled:"",selected:""},"Select a city",-1)),q=["value"],B={class:"mb-8"},Y=l(()=>s("div",{class:"mt-75%"},[s("button",{id:"btnFinish",type:"submit"}," Finish ")],-1)),J={key:0,class:"text-red-500 text-center my-4"},z={id:"btnLogin",class:"flex justify-center items-center mb-4"},G={class:"cursor-pointer"},H={type:"submit",class:"bg-black-200 text-white flex items-center"};function K(r,e,Q,W,o,n){const _=g;return i(),a("div",I,[s("div",A,[F,s("div",E,[T,s("form",{class:"mt-8 md:mt-8 md:pr-20% text-white",onSubmit:e[6]||(e[6]=f((...t)=>n.submitForm&&n.submitForm(...t),["prevent"]))},[s("div",U,[d(s("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>o.selectedCountry=t),filterable:!0,class:"form-input mt-1 col-span-10 block border-black-300 border-b white",onChange:e[1]||(e[1]=(...t)=>n.handleSelectChange&&n.handleSelectChange(...t)),required:""},[V,(i(!0),a(m,null,p(o.countriesData,t=>(i(),a("option",{key:t._id,value:t._id,white:""},u(t._name),9,L))),128))],544),[[h,o.selectedCountry]])]),s("div",M,[d(s("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>o.selectedProvince=t),filterable:!0,class:"form-input mt-1 col-span-10 block border-black-300 border-b white",onChange:e[3]||(e[3]=(...t)=>n.handleSelectProvinceChange&&n.handleSelectProvinceChange(...t)),required:""},[N,(i(!0),a(m,null,p(o.provincesData,t=>(i(),a("option",{key:t._id,value:t._id,white:""},u(t.name),9,O))),128))],544),[[h,o.selectedProvince]])]),s("div",R,[d(s("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>o.selectedCity=t),filterable:!0,class:"form-input mt-1 col-span-10 block border-black-300 border-b white",required:""},[j,(i(!0),a(m,null,p(o.citiesData,t=>(i(),a("option",{key:t._id,value:t._id,white:""},u(t.name),9,q))),128))],512),[[h,o.selectedCity]])]),s("div",B,[d(s("input",{type:"text",id:"address",name:"address",class:"form-input mt-1 block w-10/12 border-black-300 border-b white",placeholder:"Address","onUpdate:modelValue":e[5]||(e[5]=t=>o.address=t),minlength:"8",required:""},null,512),[[v,o.address]])]),Y,o.error?(i(),a("div",J,u(o.error),1)):b("",!0)],32),s("div",z,[s("label",G,[s("button",H,[C(_,{to:"/Login"},{default:y(()=>[w("Login")]),_:1})])])])])])])}const re=k(P,[["render",K],["__scopeId","data-v-d04a281d"]]);export{re as default};
